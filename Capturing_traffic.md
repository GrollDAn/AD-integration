## Захват трафика при вводе компьютера в домен

 Захват трафика во время ввода компьютера в домен является важной процедурой для последующего анализа сетевых взаимодействий. Это позволяет:
- Детально изучить процесс присоединения устройства к домену.
- Определить выполняемые условия и шаги.
- Проанализировать используемые сетевые протоколы (например, Kerberos, LDAP, SMB).
- Исследовать запросы и ответы между рабочей станцией и контроллером домена.
- Полученные данные позволяют выявить возможные проблемы или ошибки конфигурации в процессе ввода в домен.
---

 ### Подготовка машин для захвата трафика

Процесс захвата трафика может выполняться, как на стороне контроллера домена, так и на клиентской машине, которая вводится в домен. Методика одинакова для различных операционных систем (например, Windows и Linux).

Для выполнения захвата трафика необходимо:
1. **Контроллер домена** — сервер, на котором работает Active Directory.
2. **Рабочая станция** — машина, которая будет вводиться в домен.
3. **Программное обеспечение для захвата трафика** —  Wireshark.
___

### Процесс захвата трафика 

1. **Установка программы Wireshark.**  
   На ALT Linux установите программу Wireshark, используя следующую команду:  
   ```
     # apt-get install wireshark
   ``` 
 

2. **Запуск Wireshark.**  
    Откройте Wireshark на рабочей станции. Альтернативно, можно выполнить захват трафика на контроллере домена, в зависимости от задач. 

3. **Настройка фильтров для захвата трафика.**  
   Для анализа, исключительно взаимодействия между контроллером домена и рабочей станцией, настройте фильтр в Wireshark: 
   ```
   (ip.src == 192.168.1.1 && ip.dst == 192.168.1.2) || (ip.src == 192.168.1.2 && ip.dst == 192.168.1.1)
   ```
   Где:
*    192.168.1.1 — IP-адрес контроллера домена.
*    192.168.1.2 — IP-адрес рабочей станции.

4. **Выбор сетевого интерфейса.**  
   В Wireshark выберите сетевой интерфейс, который будет использоваться для захвата трафика. На рабочей станции с ALT Linux это, например, интерфейс **eth0**. Для выбора интерфейса выполните двойной щелчок по нему. 

5. **Ввод рабочей станции в домен.**  
   Выполните ввод рабочей станции в домен, используя учетные данные с правами администратора домена или учетной записи, имеющей соответствующие права. 

6. **Завершение захвата трафика.**  
   После успешного ввода рабочей станции в домен, остановите процесс захвата трафика в Wireshark, нажав на кнопку  **Stop** (красный квадрат) в верхней панели управления.  

7. **Сохранение захваченных данных.**  
  Сохраните файл с захваченным трафиком для последующего анализа. Используйте формат **pcapng**, который предлагается по умолчанию: 
  * В меню Wireshark выберите **File → Save As**.
  * Укажите имя файла и директорию для сохранения.
  * Убедитесь, что формат файла установлен как **pcapng**.

---

### Создание keytab файла

Для дальнейшего анализа захваченного трафика и расшифровки аутентификационных пакетов (например, Kerberos), необходимо создать **keytab файл**. Этот файл содержит криптографические ключи, которые используются для аутентификации пользователей и машин в домене. **Keytab** файл позволит расшифровать пакеты, связанные с процессом ввода машины в домен, и анализировать их.

___

